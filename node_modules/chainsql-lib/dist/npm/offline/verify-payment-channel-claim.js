'use strict'; // eslint-disable-line strict

var common = require('../common');
var keypairs = require('chainsql-keypairs');
var binary = require('chainsql-binary-codec');
var validate = common.validate,
    zxcToDrops = common.zxcToDrops;


function verifyPaymentChannelClaim(channel, amount, signature, publicKey) {
  validate.verifyPaymentChannelClaim({ channel: channel, amount: amount, signature: signature, publicKey: publicKey });

  var signingData = binary.encodeForSigningClaim({
    channel: channel,
    amount: zxcToDrops(amount)
  });
  return keypairs.verify(signingData, signature, publicKey);
}

module.exports = verifyPaymentChannelClaim;